<html>

<head>
    <title>Canvas</title>
    <sxcript src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></sxcript>
    <script src="../js/libs/jquery-3.1.0.min.js"></script>
    <script src="Player.js"></script>
    <script src="../js/libs/tinysynth/webaudio-tinysynth.js"></script>


    <script>
        "use strict";

        let autoStart = false;
        let player = null;
        //let synth = null;  // defined globally in Player.js

        function setProgram(idx) {
            console.log("** setProgram", idx);
            synth.send([0xc0, idx]);
        }

        // on document ready call the function to draw the circles
        $(document).ready(function () {
            synth = initSynth();
            player = new Player("myCanvas");
            player.reset();
            if (autoStart)
                player.start();
            //
        });
    </script>
</head>

<body>
    <canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">
    </canvas>
    <br>
    <button id="start" onclick="player.start();">Start</button>
    &nbsp;
    <button id="stop" onclick="player.stop();">Stop</button>
    &nbsp;
    speed:
    <input type="range" id="speedSlider" min="0" max="100" value="50" oninput="player.handleSpeed(this.value);">
    &nbsp;
    acc-dec:
    <input type="range" id="accSlider" min="0" max="100" value="50" oninput="player.handleAcc(this.value);">
    <br>
    <span id="status"></span>
    <span id="speed"></span>
    <div id="keys">
        Play by keys :<br />
        <button onmousedown="synth.send([0x90,60,100])" onmouseup="synth.send([0x80,60,0])">C</button>
        <button onmousedown="synth.send([0x90,62,100])" onmouseup="synth.send([0x80,62,0])">D</button>
        <button onmousedown="synth.send([0x90,64,100])" onmouseup="synth.send([0x80,64,0])">E</button>
        <button onmousedown="synth.send([0x90,65,100])" onmouseup="synth.send([0x80,65,0])">F</button>
        <button onmousedown="synth.send([0x90,67,100])" onmouseup="synth.send([0x80,67,0])">G</button>
        <button onmousedown="synth.send([0x90,69,100])" onmouseup="synth.send([0x80,69,0])">A</button>
        <button onmousedown="synth.send([0x90,71,100])" onmouseup="synth.send([0x80,71,0])">B</button>
        <button onmousedown="synth.send([0x90,72,100])" onmouseup="synth.send([0x80,72,0])">C</button>
    </div>
    Quality:
    <select onchange="synth.setQuality(this.selectedIndex)">
        <option>Quality=0</option>
        <option selected>Quality=1</option>
    </select>
    <br />
    Timbre : <select id="prog" onchange="setProgram(this.selectedIndex)"></select>
    <br />
</body>

</html>